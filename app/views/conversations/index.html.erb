<h1>Messages</h1>

<% if @conversations.any? %>
  <div class="conversations-list">
    <% @conversations.each do |conversation| %>
      <div class="conversation-summary">
        <%= link_to conversation_path(conversation) do %>
          <h2>Conversation with <%= conversation.other_party(current_user).username %></h2>
          <% if conversation.messages.any? %>
            <p>Last message: <%= conversation.messages.last.body.truncate(50) %></p>
          <% else %>
            <p>No messages yet.</p>
          <% end %>
        <% end %>
      </div>
    <% end %>
  </div>
  <% if @conversations.any? %>
  <% else %>
    <p class="no-conversations">You have no conversations yet.</p>
  <% end %>
<% end %>